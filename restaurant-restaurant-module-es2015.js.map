{"version":3,"sources":["./src/app/resolvers/session/session-admin.resolver.ts","./src/app/restaurant/restaurant.module.ts","./src/app/restaurant/restaurant.routing.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAyC;AACoD;AAC1C;AACf;AACiD;AAClD;AACF;AAGjC,IAAa,oBAAoB,GAAjC,MAAa,oBAAoB;IAE/B,YAAoB,YAAiC,EACjC,QAAwB,EACxB,MAAc;QAFd,iBAAY,GAAZ,YAAY,CAAqB;QACjC,aAAQ,GAAR,QAAQ,CAAgB;QACxB,WAAM,GAAN,MAAM,CAAQ;IAClC,CAAC;IAED,OAAO,CAAC,KAA6B,EAAE,KAA0B;QAC/D,MAAM,OAAO,GAAkB,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QACrE,IAAI,mCAAM,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,cAAc,CAAC,0CAAU,EAAE,CAAC,EAAE;YAC/D,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;YACzC,OAAO;SACR;QAED,IAAI,OAAO,IAAI,OAAO,CAAC,KAAK,IAAI,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE;YAClD,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACrC,OAAO,+CAAE,CAAC,OAAO,CAAC,CAAC;SACpB;QAED,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;aACzB,IAAI,CAAC,0DAAG,CAAC,GAAG,CAAC,EAAE;YACd,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE;gBACjB,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;aAC1C;QACH,CAAC,CAAC,CAAC,CAAC;IACR,CAAC;CACF;;YAxBmC,kEAAmB;YACvB,oFAAc;YAChB,sDAAM;;AAJvB,oBAAoB;IADhC,gEAAU,CAAC,EAAC,UAAU,EAAE,MAAM,EAAC,CAAC;2EAGG,kEAAmB;QACvB,oFAAc;QAChB,sDAAM;GAJvB,oBAAoB,CA0BhC;AA1BgC;;;;;;;;;;;;;;;;;;;;ACTM;AACM;AACU;AAUvD,IAAa,gBAAgB,GAA7B,MAAa,gBAAgB;CAC5B;AADY,gBAAgB;IAP5B,8DAAQ,CAAC;QACR,YAAY,EAAE,EAAE;QAChB,OAAO,EAAE;YACP,4DAAY;YACZ,qEAAiB;SAClB;KACF,CAAC;GACW,gBAAgB,CAC5B;AAD4B;;;;;;;;;;;;;;;;;;;;ACZU;AACc;AAC8B;AAGnF,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,YAAY,EAAE,8CAA8C;QAC5D,OAAO,EAAE;YACP,OAAO,EAAE,kGAAoB;SAC9B;KACF;IACD,sDAAsD;IACtD,EAAC,IAAI,EAAE,MAAM,EAAE,YAAY,EAAE,+BAA+B,EAAC;CAE9D,CAAC;AAMF,IAAa,iBAAiB,GAA9B,MAAa,iBAAiB;CAC7B;AADY,iBAAiB;IAJ7B,8DAAQ,CAAC;QACR,OAAO,EAAE,CAAC,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,4DAAY,CAAC;KACxB,CAAC;GACW,iBAAiB,CAC7B;AAD6B","file":"restaurant-restaurant-module-es2015.js","sourcesContent":["import {Injectable} from '@angular/core';\nimport {ActivatedRouteSnapshot, Resolve, Router, RouterStateSnapshot} from '@angular/router';\nimport {LocalStorageService} from 'ngx-webstorage';\nimport {Observable, of} from 'rxjs';\nimport {LoginResponse, SessionService} from '@app/_services/session/session.service';\nimport {tap} from 'rxjs/operators';\nimport * as moment from 'moment';\n\n@Injectable({providedIn: 'root'})\nexport class SessionAdminResolver implements Resolve<any> {\n\n  constructor(private localStorage: LocalStorageService,\n              private sessionS: SessionService,\n              private router: Router) {\n  }\n\n  resolve(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<LoginResponse> {\n    const session: LoginResponse = this.localStorage.retrieve('session');\n    if (moment(session.expirationTime).isSameOrBefore(moment.now())) {\n      this.router.navigateByUrl('/admin/auth');\n      return;\n    }\n\n    if (session && session.token && !!session.is_admin) {\n      this.sessionS.session$.next(session);\n      return of(session);\n    }\n\n    return this.sessionS.login()\n      .pipe(tap(res => {\n        if (!res.is_admin) {\n          this.router.navigateByUrl('/admin/auth');\n        }\n      }));\n  }\n}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {RestaurantRouting} from './restaurant.routing';\n\n\n@NgModule({\n  declarations: [],\n  imports: [\n    CommonModule,\n    RestaurantRouting\n  ]\n})\nexport class RestaurantModule {\n}\n","import {NgModule} from '@angular/core';\nimport {Routes, RouterModule} from '@angular/router';\nimport {SessionAdminResolver} from '@app/resolvers/session/session-admin.resolver';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    loadChildren: './dashboard/dashboard.module#DashboardModule',\n    resolve: {\n      session: SessionAdminResolver\n    },\n  },\n  // {path: '', component: GanttTimelineChartComponent},\n  {path: 'auth', loadChildren: './auth/auth.module#AuthModule'},\n  // {path: 'plan', loadChildren: './restaurant-plan/restaurant-plan.module#RestaurantPlanModule'}\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class RestaurantRouting {\n}\n"],"sourceRoot":"webpack:///"}